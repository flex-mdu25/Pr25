<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link
      href="https://image.makewebeasy.net/makeweb/0/pMrtkmxgt/APNG_images/bot_02.png?v=202012190947"
      rel="shortcut icon"
    />
    <!-- Sweet Alert -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@8"></script>
    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
      integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2"
      crossorigin="anonymous"
    />
    <title>Share Flex Message</title>
  </head>
  <body>
    <div class="text-center mt-5">
      <p>กำลังโหลด...</p>
      <img
        src="https://image.makewebeasy.net/makeweb/0/pMrtkmxgt/APNG_images/loader1_1.gif?v=202012190947"
        alt="loading"
        width="126"
        height="129"
      />
      <p>กรุณารอสักครู่</p>
    </div>

    <!-- LIFF JavaScript -->
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <script>
      // Helper function to get URL parameters
      function getParameterByName(name, url = window.location.href) {
        name = name.replace(/[\[\]]/g, '\\$&');
        const regex = new RegExp(`[?&]${name}(=([^&#]*)|&|#|$)`);
        const results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, ' '));
      }

      // Initialize LIFF
      window.onload = function () {
        liff.init({ liffId: "2005881370-g7q009lj" })
          .then(() => {
            if (liff.isLoggedIn()) {
              handleLIFF();
            } else {
              liff.login();
            }
          })
          .catch((err) => {
            console.error("LIFF Initialization failed:", err);
            alert("ไม่สามารถเริ่มต้น LIFF ได้");
          });
      };

      function handleLIFF() {
        const referParam = getParameterByName("refer");

        if (referParam === "ex0") {
          liff.sendMessages([
            {
              type: "text",
              text: "สวัสดีปีใหม่ ๒๕๖๘"
            }
          ])
            .then(() => {
              Swal.fire({
                icon: 'success',
                title: 'ส่งข้อความสำเร็จ!',
                text: 'ข้อความของคุณถูกส่งแล้ว',
                timer: 2000,
                showConfirmButton: false
              }).then(() => {
                liff.closeWindow();
              });
            })
            .catch((err) => {
              console.error("Error sending message:", err);
              alert("เกิดข้อผิดพลาดในการส่งข้อความ");
            });
        } else if (referParam === "sharepr1") {
          liff.shareTargetPicker([
            {
              type: "flex",
              altText: "สวัสดีปีใหม่ ๒๕๖๘",
              contents: 

                
{
  "type": "bubble",
  "size": "giga",
  "body": {
    "type": "box",
    "layout": "vertical",
    "contents": [
      {
        "type": "image",
        "url": "https://raw.githubusercontent.com/flex-mdu25/Pr25/refs/heads/main/newyear2.png",
        "size": "full",
        "aspectMode": "cover",
        "aspectRatio": "1.5:2",
        "gravity": "center"
      },
      {
        "type": "box",
        "layout": "vertical",
        "contents": [],
        "position": "absolute",
        "background": {
          "type": "linearGradient",
          "angle": "0deg",
          "endColor": "#00000000",
          "startColor": "#00000099"
        },
        "width": "100%",
        "height": "40%",
        "offsetBottom": "0px",
        "offsetStart": "0px",
        "offsetEnd": "0px"
      },
      {
        "type": "box",
        "layout": "horizontal",
        "contents": [
          {
            "type": "image",
            "url": "https://raw.githubusercontent.com/flex-mdu25/Pr25/refs/heads/main/ktp145.png",
            "size": "xxs",
            "offsetTop": "xxl",
            "offsetStart": "150px",
            "action": {
              "type": "uri",
              "label": "action",
              "uri": "https://liff.line.me/2005881370-g7q009lj?refer=sharepr1"
            }
          }
        ],
        "position": "absolute",
        "offsetBottom": "0px",
        "offsetStart": "0px",
        "offsetEnd": "0px",
        "paddingAll": "20px"
      }
    ],
    "paddingAll": "0px"
  }
}

                





                
            }
          ])
            .then(() => {
              Swal.fire({
                icon: 'success',
                title: 'แชร์ข้อความสำเร็จ!',
                text: 'ข้อความของคุณถูกแชร์แล้ว',
                timer: 2000,
                showConfirmButton: false
              });
            })
            .catch((err) => {
              console.error("Error sharing target picker:", err);
              alert("เกิดข้อผิดพลาดในการแชร์ข้อความ");
            });
        }
      }
    </script>

    <!-- Bootstrap JS -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
